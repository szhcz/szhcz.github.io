<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="https://raw.githubusercontent.com/szhcz/myImg/main/花海.png?token=A2GDWN4DQNTRN6BYWIAA7ZLGSNYEI">
  
  <title>DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation | szh&#39;s Blog</title>
  
  <meta name="author" content="szh" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="Diffusion Model, 论文阅读" />
  
  <meta name="description" content="1. 研究背景、动机、主要贡献 1.1 存在问题(动机) 现有的文本到图像生成模型可以根据文本提示生成高质量和多样化的图像，但它们无法在不同的场景中一致地再现特定主体。 因为即使使用详细的文本描述，现有模型的输出域表达力有限，生成的图像可能会与给定的参考主体外观不同。 1.2 主要贡献 作者提出了一种“个性化”方法，将主体绑定到模型的输出域中（不是在潜在空间操作，是在像素层面），使其可以根据用户提">
<meta property="og:type" content="article">
<meta property="og:title" content="DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation">
<meta property="og:url" content="https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/index.html">
<meta property="og:site_name" content="szh&#39;s Blog">
<meta property="og:description" content="1. 研究背景、动机、主要贡献 1.1 存在问题(动机) 现有的文本到图像生成模型可以根据文本提示生成高质量和多样化的图像，但它们无法在不同的场景中一致地再现特定主体。 因为即使使用详细的文本描述，现有模型的输出域表达力有限，生成的图像可能会与给定的参考主体外观不同。 1.2 主要贡献 作者提出了一种“个性化”方法，将主体绑定到模型的输出域中（不是在潜在空间操作，是在像素层面），使其可以根据用户提">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/https:/raw.githubusercontent.com/szhcz/myImg/main/image-20240923075705574.png">
<meta property="article:published_time" content="2024-09-21T16:00:00.000Z">
<meta property="article:modified_time" content="2024-09-22T16:00:00.000Z">
<meta property="article:author" content="szh">
<meta property="article:tag" content="论文阅读">
<meta property="article:tag" content="Diffusion Model">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/https:/raw.githubusercontent.com/szhcz/myImg/main/image-20240923075705574.png">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" media="all"></script>
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-color-dark.min.css" media="(prefers-color-scheme: dark)"></script>
    <script src="/js/kr-dark.min.js"></script>
  
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" media="all"></script>
  
  <link rel="stylesheet" id="fontawe-css" href="/vendors/font-awesome@4.7.0/css/font-awesome.min.css" media="all"></script>
  <link rel="stylesheet" id="nprogress-css" href="/vendors/nprogress@0.2.0/nprogress.css" media="all"></script>
  
  
    <link rel="stylesheet" href="/vendors/aplayer@1.10.1/dist/APlayer.min.css"></script>
  
  
    <link rel="stylesheet" href="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"></script>
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="/vendors/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="/vendors/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li>
                                            
                                                <a href="/">
                                            
                                                
                                                    <i class="fa fa-home"></i>
                                                
                                                首页
                                            </a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="/archives/">
                                            
                                                
                                                    <i class="fa fa-film"></i>
                                                
                                                时间轴
                                            </a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="/categories/">
                                            
                                                
                                                    <i class="fa fa-folder-open"></i>
                                                
                                                分类
                                            </a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="/tags/">
                                            
                                                
                                                    <i class="fa fa-tags"></i>
                                                
                                                标签
                                            </a>
                                            
                                        </li>
                                    
                                        <li>
                                            
                                                <a href="/search/">
                                            
                                                
                                                    <i class="fa fa-search"></i>
                                                
                                                搜索
                                            </a>
                                            
                                        </li>
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">szh&#39;s Blog</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>szh&#39;s Blog</h2> <br />
                        <span>嗨 是你啊</span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article itemscope itemtype="https://schema.org/Article">
    
        <link itemprop="mainEntityOfPage" href="https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/">
        <div class="kratos-hentry kratos-post-inner clearfix">
            <header class="kratos-entry-header">
                
                    <h1 class="kratos-entry-title text-center" itemprop="name headline">DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation</h1>
                    
                        
                                <ul class="kratos-post-meta text-center">
                                    <li><time datetime="2024-09-21T16:00:00.000Z" itemprop="datePublished"><i
                                                class="fa fa-calendar"></i> 2024-09-22</time></li>
                                    <li itemprop="author" itemscope itemtype="https://schema.org/Person">
                                        <i class="fa fa-user"></i> 作者 <span itemprop="name">szh</span>
                                    </li>
                                    
                                        <li>
                                            <i class="fa fa-edit"></i>
                                            
                                                
                                                            ~
                                                                    4.64K
                                                                        
                                                                            字
                                        </li>
                                        
                                            
                                </ul>
            </header>
            <div class="kratos-post-content">
                
                        
                            
                                <div class="kratos-post-inner-toc toc-div-class" >
                                        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">1. 研究背景、动机、主要贡献</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98-%E5%8A%A8%E6%9C%BA"><span class="toc-text">1.1 存在问题(动机)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE"><span class="toc-text">1.2 主要贡献</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="toc-text">1.3 相关工作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">2. 论文提出的新方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Text-to-Image-Diffusion-Models"><span class="toc-text">2.1 Text-to-Image Diffusion Models</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Personalization-of-Text-to-Image-Models"><span class="toc-text">2.2 Personalization of Text-to-Image Models</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-Designing-Prompts-for-Few-Shot-Personalization"><span class="toc-text">2.2.1 Designing Prompts for Few-Shot Personalization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-Rare-token-Identifiers"><span class="toc-text">2.2.2 Rare-token Identifiers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-Class-specific-Prior-Preservation-Loss"><span class="toc-text">2.3 Class-specific Prior Preservation Loss</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">3. 论文实验评估方法与效果</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DreamBooth-%E4%B8%8E-Textual-Inversion%E7%9A%84%E5%AF%B9%E6%AF%94%E5%AE%9E%E9%AA%8C"><span class="toc-text">DreamBooth 与 Textual Inversion的对比实验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ablation-Studies"><span class="toc-text">Ablation Studies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prior-Preservation-Loss-Ablation"><span class="toc-text">Prior Preservation Loss Ablation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Class-Prior-Ablation"><span class="toc-text">Class-Prior Ablation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%BA%94%E7%94%A8"><span class="toc-text">关键应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">4. 论文局限性</span></a></li></ol>
                                </div>
                                
                                    <hr />
                                    <div itemprop="articleBody"><h1>1. 研究背景、动机、主要贡献</h1>
<h2 id="1-1-存在问题-动机">1.1 存在问题(动机)</h2>
<p>现有的文本到图像生成模型可以根据文本提示生成高质量和多样化的图像，但它们无法<em>在不同的场景中一致地再现特定主体</em>。<br>
因为即使使用详细的文本描述，现有模型的输出域表达力有限，生成的图像可能会与给定的参考主体外观不同。</p>
<h2 id="1-2-主要贡献">1.2 主要贡献</h2>
<p>作者提出了一种“个性化”方法，将主体绑定到模型的<strong>输出域</strong>中（不是在潜在空间操作，是在像素层面），使其可以根据用户提供的图像生成新图像。<br>
具体来说，用户提供一些主体的图片（大约3-5张），模型通过微调生成包含该主体的图像，且能在不同场景下保持主体的关键特征。</p>
<p>本文的技术是第一个解决<em>主题驱动生成</em>这一新的挑战性问题的技术，允许用户从几张随意拍摄的主题图像中合成该主题在不同背景下的新颖再现，同时保持其特色鲜明。</p>
<h2 id="1-3-相关工作">1.3 相关工作</h2>
<ul>
<li>
<p>图像合成</p>
<ul>
<li>图像合成技术的目标是将给定的主体融入新背景中，使其看起来自然。这通常依赖<em>3D重建技术</em>，但这些方法往往仅适用于刚性物体，且需要大量视角。它们在处理<em>光照、阴影</em>等场景整合问题时表现不足，无法生成全新的场景。</li>
<li>本文提出的方法能够生成在新姿势和场景中的主体图像。</li>
</ul>
</li>
<li>
<p>文本驱动的图像编辑和合成</p>
<ul>
<li>近年来，结合生成对抗网络和图像文本表示的文本驱动图像编辑取得了显著进展。然而，这些方法通常只适用于结构化场景（例如人脸编辑），在处理多样化主体时效果不佳。</li>
<li>最近的扩散模型在多样化数据集上的生成质量超越了GAN，但仍无法一致地保持特定主体在生成图像中的身份。</li>
<li>现有大规模文本到图像生成模型（如Imagen、DALL-E2、Stable Diffusion等）虽然生成效果突出，但难以精细控制生成图像，特别是保持主体的一致性。</li>
</ul>
</li>
<li>
<p>可控生成模型：</p>
<ul>
<li>有多种方法用于控制生成模型，其中一些方法可能适用于以主体为驱动的图像生成任务。例如，Liu等提出的基于扩散的技术可以通过参考图像或文本进行图像变体生成，但这些方法在保持主体特征方面表现不佳。</li>
<li>一些方法使用用户提供的掩码限制修改区域，但这些方法仍无法生成具有一致身份的主体在新场景中的新图像。</li>
<li>在GAN领域，一些方法允许通过微调模型来编辑真实图像，但这些方法通常需要大量图像且仅限于特定领域，如人脸。</li>
</ul>
</li>
</ul>
<h1>2. 论文提出的新方法</h1>
<h2 id="2-1-Text-to-Image-Diffusion-Models">2.1 Text-to-Image Diffusion Models</h2>
<p>这部分的思路在引入了条件向量这一点和LDM差不多，但是 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.373ex" height="1.005ex" role="img" focusable="false" viewBox="0 -444 607 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z"></path></g></g></g></g></svg></mjx-container> 是真实图像，LDM却没有在像素层面操作。</p>
<p>LDM中是预测噪声， $L_{\mathrm{LDM}}=\mathbb{E}<em>{E(x),y,\epsilon\sim N(0,1),t}\begin{bmatrix}|\epsilon-\epsilon</em>\theta(z_t,t,\tau_\theta(y))|_2^2\end{bmatrix}$</p>
<p>本文是希望直接优化图片（至少这个公式是这样的）， $\mathbb{E}<em>{\mathbf{x},\mathbf{c},\boldsymbol{\epsilon},t}\big[w_t|\hat{\mathbf{x}}</em>\theta(\alpha_t\mathbf{x}+\sigma_t\boldsymbol{\epsilon},\mathbf{c})-\mathbf{x}|_2^2\big]$</p>
<ul>
<li>条件向量 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="9.126ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4033.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D41C" d="M447 131H458Q478 131 478 117Q478 112 471 95T439 51T377 9Q330 -6 286 -6Q196 -6 135 35Q39 96 39 222Q39 324 101 384Q169 453 286 453Q359 453 411 431T464 353Q464 319 445 302T395 284Q360 284 343 305T325 353Q325 380 338 396H333Q317 398 295 398H292Q280 398 271 397T245 390T218 373T197 338T183 283Q182 275 182 231Q182 199 184 180T193 132T220 85T270 57Q289 50 317 50H326Q385 50 414 115Q419 127 423 129T447 131Z"></path></g></g><g data-mml-node="mo" transform="translate(788.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(1844.6,0)"><path data-c="393" d="M128 619Q121 626 117 628T101 631T58 634H25V680H554V676Q556 670 568 560T582 444V440H542V444Q542 445 538 478T523 545T492 598Q454 634 349 634H334Q264 634 249 633T233 621Q232 618 232 339L233 61Q240 54 245 52T270 48T333 46H360V0H348Q324 3 182 3Q51 3 36 0H25V46H58Q100 47 109 49T128 61V619Z"></path></g><g data-mml-node="mo" transform="translate(2469.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2858.6,0)"><g data-mml-node="mi"><path data-c="1D40F" d="M400 0Q376 3 226 3Q75 3 51 0H39V62H147V624H39V686H253Q435 686 470 685T536 678Q585 668 621 648T675 605T705 557T718 514T721 483T718 451T704 409T673 362T616 322T530 293Q500 288 399 287H304V62H412V0H400ZM553 475Q553 554 537 582T459 622Q451 623 373 624H298V343H372Q457 344 480 350Q527 362 540 390T553 475Z"></path></g></g><g data-mml-node="mo" transform="translate(3644.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> ，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.778ex" height="1.552ex" role="img" focusable="false" viewBox="0 -686 786 686"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D40F" d="M400 0Q376 3 226 3Q75 3 51 0H39V62H147V624H39V686H253Q435 686 470 685T536 678Q585 668 621 648T675 605T705 557T718 514T721 483T718 451T704 409T673 362T616 322T530 293Q500 288 399 287H304V62H412V0H400ZM553 475Q553 554 537 582T459 622Q451 623 373 624H298V343H372Q457 344 480 350Q527 362 540 390T553 475Z"></path></g></g></g></g></svg></mjx-container> 是文本提示</li>
<li><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.373ex" height="1.005ex" role="img" focusable="false" viewBox="0 -444 607 444"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z"></path></g></g></g></g></svg></mjx-container> 是真实图像</li>
<li><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="8.668ex" height="1.441ex" role="img" focusable="false" viewBox="0 -443 3831.1 637"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z"></path></g><g data-mml-node="TeXAtom" transform="translate(673,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g><g data-mml-node="mo" transform="translate(978.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(1422.9,0)"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="TeXAtom" transform="translate(604,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g><g data-mml-node="mo" transform="translate(2332.2,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="msub" transform="translate(2776.9,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z"></path></g><g data-mml-node="TeXAtom" transform="translate(749,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></g></g></svg></mjx-container> 是控制噪声表和样本质量的项</li>
</ul>
<h2 id="2-2-Personalization-of-Text-to-Image-Models">2.2 Personalization of Text-to-Image Models</h2>
<p>使用少量样本数据来微调模型，但这种方式容易导致<strong>过拟合</strong>或<strong>模式崩溃</strong>。人们已经对避免这些陷阱的技术进行了研究，但这些研究通常不涉及<strong>主体的保留</strong>。</p>
<p>此外作者发现大型文本到图像的扩散模型似乎擅长将新信息集成到其领域中，而不会忘记先验信息或过度拟合一小组训练图像</p>
<h3 id="2-2-1-Designing-Prompts-for-Few-Shot-Personalization">2.2.1 Designing Prompts for Few-Shot Personalization</h3>
<p>目标是将一个新的“<strong>唯一标识符</strong>”与主体绑定，植入模型的“字典”中，使模型可以识别和生成该主体的多样化图像。</p>
<p>为简化操作，模型并不需要每张图片的详细描述，而是使用简单的标签，如 <code>a [identifier] [class noun]</code></p>
<ul>
<li><code>[identifier]</code>  是唯一标识符，指代具体的主体；</li>
<li><code>[class noun]</code>  是该主体的粗略类别描述（如猫、狗、手表等）。</li>
<li>类描述符可以由用户提供或通过分类器获得。这种方式利用了模型对类别的先验知识，使其生成符合该类别的多样化图像。如果使用错误的类别描述，可能会增加训练时间并降低生成质量。</li>
</ul>
<h3 id="2-2-2-Rare-token-Identifiers">2.2.2 Rare-token Identifiers</h3>
<ul>
<li>一些常用的英语单词（如“unique”、“special”）不适合作为标识符，因为模型需要学习将这些词与其原始含义区分开，并重新与主体绑定，这增加了学习难度。</li>
<li>因此，需要选择<strong>稀有标记符</strong>，即在语言模型和扩散模型中都有较弱先验的标识符。通过<em>随机选取一些字母组合生成稀有标识符并不理想</em>，因为模型往往会将每个字母单独处理，导致这些标识符仍然具有较强的先验知识。</li>
</ul>
<p>本文提出通过查找模型词汇表中的稀有标记符，通过去标记器将这些标记符转化为对应的文本字符序列，得到实际的标识符。</p>
<ol>
<li>从词汇表中查找<em>稀有标记符</em>，得到一系列<em>稀有标记符的标记序列 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.971ex" height="2.95ex" role="img" focusable="false" viewBox="0 -1054 2197 1304"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(939,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D415" d="M592 686H604Q615 685 631 685T666 684T700 684T724 683Q829 683 835 686H843V624H744L611 315Q584 254 546 165Q492 40 482 19T461 -6L460 -7H409Q398 -4 391 9Q385 20 257 315L124 624H25V686H36Q57 683 190 683Q340 683 364 686H377V624H289L384 403L480 185L492 212Q504 240 529 298T575 405L670 624H582V686H592Z"></path></g></g><g data-mml-node="mo" transform="translate(434.5,260) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1808,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></em> ，该序列可以具有可变长度 k，并且发现相对较短的 k = {1, …, 3} 序列效果很好 。 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.016ex;" xmlns="http://www.w3.org/2000/svg" width="1.966ex" height="2.4ex" role="img" focusable="false" viewBox="0 -1054 869 1061"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D415" d="M592 686H604Q615 685 631 685T666 684T700 684T724 683Q829 683 835 686H843V624H744L611 315Q584 254 546 165Q492 40 482 19T461 -6L460 -7H409Q398 -4 391 9Q385 20 257 315L124 624H25V686H36Q57 683 190 683Q340 683 364 686H377V624H289L384 403L480 185L492 212Q504 240 529 298T575 405L670 624H582V686H592Z"></path></g></g><g data-mml-node="mo" transform="translate(434.5,260) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g></g></svg></mjx-container> 是源自标记 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.971ex" height="2.95ex" role="img" focusable="false" viewBox="0 -1054 2197 1304"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(939,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D415" d="M592 686H604Q615 685 631 685T666 684T700 684T724 683Q829 683 835 686H843V624H744L611 315Q584 254 546 165Q492 40 482 19T461 -6L460 -7H409Q398 -4 391 9Q385 20 257 315L124 624H25V686H36Q57 683 190 683Q340 683 364 686H377V624H289L384 403L480 185L492 212Q504 240 529 298T575 405L670 624H582V686H592Z"></path></g></g><g data-mml-node="mo" transform="translate(434.5,260) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1808,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 的解码文本。</li>
<li>通过 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.971ex" height="2.95ex" role="img" focusable="false" viewBox="0 -1054 2197 1304"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(939,0)"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D415" d="M592 686H604Q615 685 631 685T666 684T700 684T724 683Q829 683 835 686H843V624H744L611 315Q584 254 546 165Q492 40 482 19T461 -6L460 -7H409Q398 -4 391 9Q385 20 257 315L124 624H25V686H36Q57 683 190 683Q340 683 364 686H377V624H289L384 403L480 185L492 212Q504 240 529 298T575 405L670 624H582V686H592Z"></path></g></g><g data-mml-node="mo" transform="translate(434.5,260) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1808,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 上的去标记器将标记序列解码为<em>字符序列</em>，生成定义唯一标识符 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.016ex;" xmlns="http://www.w3.org/2000/svg" width="1.966ex" height="2.4ex" role="img" focusable="false" viewBox="0 -1054 869 1061"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D415" d="M592 686H604Q615 685 631 685T666 684T700 684T724 683Q829 683 835 686H843V624H744L611 315Q584 254 546 165Q492 40 482 19T461 -6L460 -7H409Q398 -4 391 9Q385 20 257 315L124 624H25V686H36Q57 683 190 683Q340 683 364 686H377V624H289L384 403L480 185L492 212Q504 240 529 298T575 405L670 624H582V686H592Z"></path></g></g><g data-mml-node="mo" transform="translate(434.5,260) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g></g></svg></mjx-container> 的字符序列。</li>
<li>对于Imagen模型，选择3个或更少Unicode字符的标记，并使用T5-XXL标记器范围内的标记（如5000到10000之间的标记）效果较好。</li>
</ol>
<h2 id="2-3-Class-specific-Prior-Preservation-Loss">2.3 Class-specific Prior Preservation Loss</h2>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923075705574.png" alt=""></p>
<ul>
<li>语言漂移
<ul>
<li>在语言模型中，当模型从大规模文本语料库上预训练后，再进行特定任务的微调时，模型会逐渐失去其对语言的语法和语义理解能力。本文首次发现了类似现象在扩散模型中的存在，模型在对特定主体进行微调时，逐渐忘记了如何生成该类主体（例如，目标主体所属类别的其他对象，如生成特定狗的图像时，可能逐渐失去生成其他狗的能力）。</li>
</ul>
</li>
<li>输出多样性减少
<ul>
<li>扩散模型本身具备生成多样化图像的能力，但在对少量图像进行微调时，可能会导致模型生成的主体视角、姿势等变得单一，特别是在训练过长时间后，模型往往会“固定”在少数几个训练视角上。</li>
</ul>
</li>
</ul>
<p>为了缓解上述两个问题，作者提出了一种<strong>自生成的类特定先验保持损失</strong>。这个方法的核心思想是用模型自己生成的样本来监督模型，以便在小样本微调开始后保留先验信息。</p>
<ul>
<li>在模型微调之前，利用冻结的预训练扩散模型生成一定数量的属于相同类别的样本 $\mathbf{x}<em>{\mathbf{pr}} = \hat{\mathbf{x}}(\mathbf{z}</em>{t_1},\mathbf{c}<em>{\mathbf{pr}})<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 1000 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mo"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">。</text></g></g></g></g></svg></mjx-container>\mathbf{z}</em>{t_1} \sim \mathcal{N}(\mathbf{0},\mathbf{I})<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.452ex;" xmlns="http://www.w3.org/2000/svg" width="2.262ex" height="2.149ex" role="img" focusable="false" viewBox="0 -750 1000 950"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">，</text></g></g></g></svg></mjx-container>\mathbf{c_{pr}}:=\Gamma(f(\text{”a [class noun]"}))$ 。</li>
<li>这些样本被用于保持模型的先验知识，并在微调过程中通过损失函数来监督模型。</li>
</ul>
<p>损失函数设计</p>
<ul>
<li>
<p>$\mathbb{E}<em>{\mathbf{x},\mathbf{c},\boldsymbol{\epsilon},\boldsymbol{\epsilon}<sup>{\prime},t}[w_t|\hat{\mathbf{x}}_\theta(\alpha_t\mathbf{x}+\sigma_t\boldsymbol{\epsilon},\mathbf{c})-\mathbf{x}|_2</sup>2+<span>\</span>lambda w</em>{t<sup>{\prime}}|\hat{\mathbf{x}}_\theta(\alpha_{t</sup>{\prime}}\mathbf{x}<em>{\mathrm{pr}}+\sigma</em>{t<sup>{\prime}}\boldsymbol{\epsilon}</sup>{\prime},\mathbf{c}<em>{\mathrm{pr}})-\mathbf{x}</em>{\mathrm{pr}}|_2^2],$</p>
</li>
<li>
<p>损失函数的第一项是用于去噪的传统扩散模型损失。</p>
</li>
<li>
<p>损失函数的第二项是先验保持损失，它用自己生成的图像来监督模型，并且 λ 控制该项的相对权重。</p>
</li>
<li>
<p>该方法不仅提高了模型输出的多样性，还有效解决了语言漂移问题，允许模型进行更多的训练迭代而不会出现过拟合。</p>
</li>
<li>
<p>通过实验，作者发现约1000次迭代、学习率为<code>1e-5</code>（Imagen）或<code>5e-6</code>（Stable Diffusion）时，能够获得良好的结果。使用3到5张主体图像作为训练数据，每次训练大约生成1000个“a [class noun]”样本，整个训练过程在TPUv4（Imagen）或NVIDIA A100（Stable Diffusion）上仅需5分钟。</p>
</li>
</ul>
<h1>3. 论文实验评估方法与效果</h1>
<p><strong>Subject Fidelity（主体保真度）</strong><br>
衡量生成图像与输入图像中的主体是否一致，尤其是细节保留。CLIP-I可以用于这个目的，但DINO由于其自监督训练方式，鼓励区分主题或图像的独特特征，更适合用来区分相似主体，效果更好。</p>
<p><strong>Prompt Fidelity（提示保真度）</strong>:<br>
评估生成的图像是否准确反映了输入的文本提示。CLIP-T通过比较生成图像与文本提示的CLIP嵌入来计算相似度，从而衡量提示的准确性。</p>
<h2 id="DreamBooth-与-Textual-Inversion的对比实验">DreamBooth 与 Textual Inversion的对比实验</h2>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923082658670.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923082821522.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923082950120.png" alt=""></p>
<h2 id="Ablation-Studies">Ablation Studies</h2>
<h3 id="Prior-Preservation-Loss-Ablation">Prior Preservation Loss Ablation</h3>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923083812253.png" alt=""></p>
<ul>
<li>PRES 用来衡量先验信息保持情况</li>
<li>DIV 衡量的是生成图像的多样性</li>
</ul>
<h3 id="Class-Prior-Ablation">Class-Prior Ablation</h3>
<p><img src="https://raw.githubusercontent.com/szhcz/myImg/main/image-20240923085318019.png" alt=""></p>
<ul>
<li>正确的类名对于微调生成模型至关重要，能够引导模型更好地利用类的先验知识，从而生成高质量且一致的图像。</li>
<li>错误类名会导致类先验和主体特征之间的冲突，生成的结果往往失真或不合逻辑。</li>
<li>不使用类名则会使模型缺乏生成的引导，导致生成结果质量低下，训练难以收敛。</li>
</ul>
<h2 id="关键应用">关键应用</h2>
<ul>
<li>重新场景化（Recontextualization）</li>
<li>艺术风格呈现（Art Renditions）</li>
<li>新视角生成（Novel View Synthesis）</li>
<li>属性修改（Property Modification）</li>
</ul>
<h1>4. 论文局限性</h1>
<ul>
<li>
<p>生成的图像未能准确<em>反映给定的上下文提示</em></p>
</li>
<li>
<p>主体的<em>外观会因提示的上下文而发生变化</em></p>
</li>
<li>
<p>当提示与主体在训练数据中的原始场景相似时，模型可能会<em>过度拟合原始图像</em>，导致生成的图像缺乏变化。</p>
</li>
<li>
<p>一些主体比其他主体更容易学习（例如，狗和猫）。对于较为<em>罕见的主体</em>，模型可能无法支持足够多的变体生成。</p>
</li>
<li>
<p>在某些生成图像中，主体的<em>细节保真度</em>可能会有所下降，甚至出现虚构的主体特征。</p>
</li>
</ul>
<hr>
<p>原文链接：<a target="_blank" rel="noopener" href="https://openaccess.thecvf.com/content/CVPR2023/papers/Ruiz_DreamBooth_Fine_Tuning_Text-to-Image_Diffusion_Models_for_Subject-Driven_Generation_CVPR_2023_paper.pdf">DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation</a></p>
</div>
            </div>
            
                <div class="kratos-copyright text-center clearfix">
                    <h5 itemprop="copyrightNotice">本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
                </div>
                
                    <footer class="kratos-entry-footer clearfix">
                        
                            <div class="post-like-donate text-center clearfix" id="post-like-donate">
                                
                                        
                                            <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                                            <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "https://szhcz.github.io/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/";
            const title         = "「DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation」";
            const excerpt       = `1. 研究背景、动机、主要贡献
1.1 存在问题(动机)
现有的文本到图像生成模型可以根据文本提示生成高质量和多样化的图像，但它们无法在不同的场景中一致地再现特定主体。
因为即使使用详细的文本描述，现有模型的输出域表达力有限，生成的图...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                                                
                            </div>
                            
                                <div class="footer-tag clearfix">
                                    <div class="pull-left">
                                        <i class="fa fa-tags"></i>
                                        <a class="tag-none-link" href="/tags/Diffusion-Model/" rel="tag">Diffusion Model</a>, <a class="tag-none-link" href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" rel="tag">论文阅读</a>
                                    </div>
                                    <div class="pull-date">
                                        <time datetime="2024-09-22T16:00:00.000Z" itemprop="dateModified">最后编辑：2024-09-23</time>
                                    </div>
                                </div>
                    </footer>
        </div>
        
            <nav class="navigation post-navigation clearfix" role="navigation">
                
                    <div class="nav-previous clearfix">
                        <a title=" An Image is Worth One Word: Personalizing Text-to-Image Generation using Textual Inversion"
                            href="/posts/An-Image-is-Worth-One-Word/">&lt; 上一篇</a>
                    </div>
                    
                        
                            <div class="nav-next clearfix">
                                <a title=" Adding Conditional Control to Text-to-Image Diffusion Models"
                                    href="/posts/Adding-Conditional-Control-to-Text-to-Image-Diffusion-Models/">下一篇 &gt;</a>
                            </div>
                            
            </nav>
            
                
</article>

        

            </section>

        

                
            
    
        <section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
            <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
            
                        
                                            <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/me.jpg" loading="lazy" decoding="auto" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center">szh’s Blog</p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                14
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                4
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                3
            </span>
        </a>
    </div>
</aside>
                                                
                                    <div class="sticky-area">
                                        
                            <aside id="krw-toc" class="widget widget-kratos-toc clearfix toc-div-class" >
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar" role="progressbar" aria-label="阅读进度："></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">1. 研究背景、动机、主要贡献</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%AD%98%E5%9C%A8%E9%97%AE%E9%A2%98-%E5%8A%A8%E6%9C%BA"><span class="toc-text">1.1 存在问题(动机)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E4%B8%BB%E8%A6%81%E8%B4%A1%E7%8C%AE"><span class="toc-text">1.2 主要贡献</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E7%9B%B8%E5%85%B3%E5%B7%A5%E4%BD%9C"><span class="toc-text">1.3 相关工作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">2. 论文提出的新方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Text-to-Image-Diffusion-Models"><span class="toc-text">2.1 Text-to-Image Diffusion Models</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Personalization-of-Text-to-Image-Models"><span class="toc-text">2.2 Personalization of Text-to-Image Models</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-1-Designing-Prompts-for-Few-Shot-Personalization"><span class="toc-text">2.2.1 Designing Prompts for Few-Shot Personalization</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-2-Rare-token-Identifiers"><span class="toc-text">2.2.2 Rare-token Identifiers</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-Class-specific-Prior-Preservation-Loss"><span class="toc-text">2.3 Class-specific Prior Preservation Loss</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">3. 论文实验评估方法与效果</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DreamBooth-%E4%B8%8E-Textual-Inversion%E7%9A%84%E5%AF%B9%E6%AF%94%E5%AE%9E%E9%AA%8C"><span class="toc-text">DreamBooth 与 Textual Inversion的对比实验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ablation-Studies"><span class="toc-text">Ablation Studies</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Prior-Preservation-Loss-Ablation"><span class="toc-text">Prior Preservation Loss Ablation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Class-Prior-Ablation"><span class="toc-text">Class-Prior Ablation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%BA%94%E7%94%A8"><span class="toc-text">关键应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">4. 论文局限性</span></a></li></ol>
    </div>
</aside>
                                
                                            
  <aside id="krw-categories" class="widget widget-kratos-categories clearfix">
    <h4 class="widget-title"><i class="fa fa-folder"></i>分类目录</h4>
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine Learning</a><span class="category-list-count">10</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/Computer-Vision/">Computer Vision</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8/">大模型安全</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8/%E5%B9%BB%E8%A7%89/">幻觉</a><span class="category-list-count">3</span></li></ul></li></ul>
  </aside>


                                                
                                            
  <aside id="krw-tags" class="widget widget-kratos-tags clearfix">
    <h4 class="widget-title"><i class="fa fa-tags"></i>标签合集</h4>
      <div class="tag-clouds">
        <a href="/tags/Diffusion-Model/" style="font-size: 0.7em;">Diffusion Model</a> <a href="/tags/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8-%E5%B9%BB%E8%A7%89/" style="font-size: 0.6em;">大模型安全-幻觉</a> <a href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" style="font-size: 0.8em;">论文阅读</a>
      </div>
  </aside>

                                                
                                            
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/posts/ANIMATEDIFF-ANIMATE-YOUR-PERSONALIZEDTEXT-TO-IMAGE-DIFFUSION-MODELS-WITHOUTSPECIFIC-TUNING/"><i class="fa  fa-book"></i> ANIMATEDIFF: ANIMATE YOUR PERSONALIZEDTEXT-TO-IMAGE DIFFUSION MODELS WITHOUT SPECIFIC TUNING</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/Prompt-to-Prompt-Image-Editing-with-Cross-Attention-Control/"><i class="fa  fa-book"></i> Prompt-to-Prompt Image Editing with Cross Attention Control</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/Adding-Conditional-Control-to-Text-to-Image-Diffusion-Models/"><i class="fa  fa-book"></i> Adding Conditional Control to Text-to-Image Diffusion Models</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/DreamBooth-Fine-Tuning-Text-to-Image-Diffusion-Models-for-Subject-Driven-Generation/"><i class="fa  fa-book"></i> DreamBooth: Fine Tuning Text-to-Image Diffusion Models for Subject-Driven Generation</a>
            
          
        
          
          
            <a class="list-group-item" href="/posts/An-Image-is-Worth-One-Word/"><i class="fa  fa-book"></i> An Image is Worth One Word: Personalizing Text-to-Image Generation using Textual Inversion</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

                                                
                                    </div>
        </section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        <!-- Keep for compatibility -->
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <!-- New links -->
                        
                            <li>
                                <a target="_blank" rel="nofollow" href="https://github.com/szhcz">
                                    
                                        <i class="fa fa-github"></i>
                                    
                                </a>
                            </li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2024 szh's Blog 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by szh.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="/vendors/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
    <script defer src="/vendors/nprogress@0.2.0/nprogress.js"></script>
        <script>
            if (!window.kr) {
                window.kr = {};
            }
            window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
            window.kr.siteRoot = "/";
        </script>
        
                
                    <script async
                        src="/js/candy.min.js"></script>
                    

                        
                            <script defer src="/vendors/aplayer@1.10.1/dist/APlayer.min.js"></script>
                                
    <script defer src="/vendors/meting@2.0.1/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="2129920743"
        order="random"
        fixed="true"
    >
    </meting-js>

                                    
                                        
                                            <script defer src="/vendors/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
                                                
                                                    <script defer src="/js/kratosr.min.js"></script>
                                                        <script defer src="/js/pjax.min.js"></script>
                                                            
                                                                        <!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-5FHZQSSYVW"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag("js", new Date());  gtag("config", "G-5FHZQSSYVW");</script>

                                                                            <!-- Extra support for third-party plguins  -->
                                                                            
    </body>
</html>